<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Export Geospatial Data and Regional Metrics to MongoDB — export_geos • coasts</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Export Geospatial Data and Regional Metrics to MongoDB — export_geos"><meta name="description" content="Downloads and processes geospatial data from two sources (Kenya and Zanzibar),
harmonizes their structures, applies currency conversions to regional time series
metrics, and exports all data to MongoDB collections with appropriate indexing."><meta property="og:description" content="Downloads and processes geospatial data from two sources (Kenya and Zanzibar),
harmonizes their structures, applies currency conversions to regional time series
metrics, and exports all data to MongoDB collections with appropriate indexing."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">coasts</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Export Geospatial Data and Regional Metrics to MongoDB</h1>

      <div class="d-none name"><code>export_geos.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Downloads and processes geospatial data from two sources (Kenya and Zanzibar),
harmonizes their structures, applies currency conversions to regional time series
metrics, and exports all data to MongoDB collections with appropriate indexing.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">export_geos</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>None (invisible). Creates and uploads data to three MongoDB collections:
  - Regional boundary geometries (with 2dsphere index)
  - Regional time series metrics (currency-converted)
  - PDS track grid summaries</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function performs several key operations:</p>
<p>**Geospatial Data Processing:**
1. Downloads GeoJSON files for Kenya and Zanzibar regions from cloud storage
2. Reads and combines the regional boundary data into a single dataset
3. Uploads combined geospatial data to MongoDB with 2dsphere indexing for spatial queries</p>
<p>**Regional Metrics Processing:**
4. Downloads monthly summary parquet files for both countries from cloud storage
5. Applies currency conversion factors to monetary metrics:
   - Zanzibar: multiplies values by 0.00037 (TZS to USD conversion)
   - Kenya: multiplies values by 0.0077 (KES to USD conversion)
6. Converts the following monetary fields: mean_rpue, mean_rpua, mean_price_kg
7. Uploads regional metrics to MongoDB without geospatial indexing</p>
<p>**PDS Track Grid Processing:**
8. Downloads PDS track grid summaries from cloud storage
9. Uploads grid summaries to a separate MongoDB collection</p>
<p>The function requires appropriate configuration parameters for cloud storage access
and MongoDB connection details, typically loaded via `read_config()`.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mdb_collection_push.html">mdb_collection_push</a></code> for MongoDB upload functionality
<code><a href="download_cloud_file.html">download_cloud_file</a></code> for cloud storage operations
<code><a href="read_config.html">read_config</a></code> for configuration management</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Export all geospatial data and metrics to MongoDB</span></span></span>
<span class="r-in"><span><span class="fu">export_geos</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lorenzo Longobardi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

