<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Coastal Fisheries Data Pipeline for Western Indian Ocean • coasts</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Coastal Fisheries Data Pipeline for Western Indian Ocean">
<meta name="description" content="Provides a comprehensive data pipeline for processing and analyzing coastal fisheries data from the Western Indian Ocean (WIO) region. Integrates GPS tracking data from Pelagic Data Systems (PDS), regional fisheries metadata, and geospatial information to support fisheries research and management. Features include automated data ingestion from PDS API, spatial gridding and summarization of fishing activity patterns, MongoDB integration with geospatial indexing, and cloud storage capabilities. Supports data from Kenya and Zanzibar fisheries with built-in currency conversion and regional harmonization.">
<meta property="og:description" content="Provides a comprehensive data pipeline for processing and analyzing coastal fisheries data from the Western Indian Ocean (WIO) region. Integrates GPS tracking data from Pelagic Data Systems (PDS), regional fisheries metadata, and geospatial information to support fisheries research and management. Features include automated data ingestion from PDS API, spatial gridding and summarization of fishing activity patterns, MongoDB integration with geospatial indexing, and cloud storage capabilities. Supports data from Kenya and Zanzibar fisheries with built-in currency conversion and regional harmonization.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">coasts</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="coasts">coasts<a class="anchor" aria-label="anchor" href="#coasts"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The <code>coasts</code> package provides a comprehensive data pipeline for processing and analyzing coastal fisheries data from the Western Indian Ocean (WIO) region. It integrates GPS tracking data from Pelagic Data Systems (PDS), regional fisheries metadata, and geospatial information to support fisheries research and management.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This package is designed to handle the complete workflow for coastal fisheries data processing:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Data Ingestion</strong>: Automated retrieval of GPS boat tracking data from Pelagic Data Systems</li>
<li>
<strong>Data Preprocessing</strong>: Spatial gridding and summarization of fishing activity patterns<br>
</li>
<li>
<strong>Data Export</strong>: Integration with MongoDB for data storage and geospatial analysis</li>
<li>
<strong>Metadata Management</strong>: Handling of device information and regional boundaries</li>
</ol>
<p>The package supports data from Kenya and Zanzibar fisheries, with built-in currency conversion and regional harmonization capabilities.</p>
</div>
<div class="section level2">
<h2 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h2>
<ul>
<li>
<strong>GPS Track Processing</strong>: Ingest and preprocess boat GPS tracks from PDS API</li>
<li>
<strong>Spatial Analysis</strong>: Grid-based summarization of fishing activity at multiple scales (100m-1km)</li>
<li>
<strong>Cloud Storage Integration</strong>: Seamless upload/download from Google Cloud Storage</li>
<li>
<strong>MongoDB Integration</strong>: Geospatial data storage with 2dsphere indexing</li>
<li>
<strong>Parallel Processing</strong>: Efficient handling of large datasets using parallel computation</li>
<li>
<strong>Automated Pipeline</strong>: GitHub Actions workflow for continuous data processing</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of coasts from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"WorldFishCenter/peskas.coasts"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="configuration">Configuration<a class="anchor" aria-label="anchor" href="#configuration"></a>
</h2>
<p>The package requires a <code>conf.yml</code> configuration file with the following structure:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">pds</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="at">  </span><span class="fu">token</span><span class="kw">:</span><span class="at"> </span><span class="st">"your_pds_token"</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="at">  </span><span class="fu">secret</span><span class="kw">:</span><span class="at"> </span><span class="st">"your_pds_secret"</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="at">  </span><span class="fu">pds_trips</span><span class="kw">:</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="at">    </span><span class="fu">file_prefix</span><span class="kw">:</span><span class="at"> </span><span class="st">"pds_trips"</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="at">    </span><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">"latest"</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="at">  </span><span class="fu">pds_tracks</span><span class="kw">:</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="at">    </span><span class="fu">file_prefix</span><span class="kw">:</span><span class="at"> </span><span class="st">"pds-tracks"</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="at">    </span><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">"latest"</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">storage</span><span class="kw">:</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="at">  </span><span class="fu">google</span><span class="kw">:</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="at">    </span><span class="fu">key</span><span class="kw">:</span><span class="at"> </span><span class="st">"google"</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="at">    </span><span class="fu">options</span><span class="kw">:</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="at">      </span><span class="fu">project</span><span class="kw">:</span><span class="at"> </span><span class="st">"your-project-id"</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="at">      </span><span class="fu">bucket</span><span class="kw">:</span><span class="at"> </span><span class="st">"your-bucket-name"</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="at">      </span><span class="fu">service_account_key</span><span class="kw">:</span><span class="at"> </span><span class="st">"path/to/service-account.json"</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="at">  </span><span class="fu">mongodb</span><span class="kw">:</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="at">    </span><span class="fu">connection_string</span><span class="kw">:</span><span class="at"> </span><span class="st">"mongodb://connection-string"</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="at">    </span><span class="fu">database_name</span><span class="kw">:</span><span class="at"> </span><span class="st">"your_database"</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="at">    </span><span class="fu">collection</span><span class="kw">:</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="at">      </span><span class="fu">wio_map</span><span class="kw">:</span><span class="at"> </span><span class="st">"regional_boundaries"</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="at">      </span><span class="fu">regional_metrics</span><span class="kw">:</span><span class="at"> </span><span class="st">"time_series_data"</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="at">      </span><span class="fu">pds_grids</span><span class="kw">:</span><span class="at"> </span><span class="st">"fishing_grids"</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="at">  </span><span class="fu">google_sheet_id</span><span class="kw">:</span><span class="at"> </span><span class="st">"your-google-sheet-id"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="main-functions">Main Functions<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h2>
<div class="section level3">
<h3 id="data-ingestion">Data Ingestion<a class="anchor" aria-label="anchor" href="#data-ingestion"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">coasts</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ingest GPS trip data from PDS</span></span>
<span><span class="fu"><a href="reference/ingest_pds_trips.html">ingest_pds_trips</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ingest detailed GPS track data</span></span>
<span><span class="fu"><a href="reference/ingest_pds_tracks.html">ingest_pds_tracks</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-preprocessing">Data Preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Preprocess tracks into spatial grids</span></span>
<span><span class="fu"><a href="reference/preprocess_pds_tracks.html">preprocess_pds_tracks</a></span><span class="op">(</span>grid_size <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>  <span class="co"># 500m grid cells</span></span>
<span></span>
<span><span class="co"># Available grid sizes: 100, 250, 500, 1000 meters</span></span>
<span><span class="fu"><a href="reference/preprocess_pds_tracks.html">preprocess_pds_tracks</a></span><span class="op">(</span>grid_size <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>  <span class="co"># 1km grid cells</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-export">Data Export<a class="anchor" aria-label="anchor" href="#data-export"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Export processed data to MongoDB</span></span>
<span><span class="fu"><a href="reference/export_geos.html">export_geos</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="metadata-management">Metadata Management<a class="anchor" aria-label="anchor" href="#metadata-management"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get device metadata from Google Sheets</span></span>
<span><span class="va">devices</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_metadata.html">get_metadata</a></span><span class="op">(</span>table <span class="op">=</span> <span class="st">"devices"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get all metadata tables</span></span>
<span><span class="va">all_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_metadata.html">get_metadata</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="data-pipeline-workflow">Data Pipeline Workflow<a class="anchor" aria-label="anchor" href="#data-pipeline-workflow"></a>
</h2>
<p>The package implements an automated data pipeline that runs every 2 days via GitHub Actions:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Build Container</strong>: Creates a Docker container with R and all dependencies</li>
<li>
<strong>Ingest PDS Trips</strong>: Downloads trip metadata from PDS API</li>
<li>
<strong>Ingest PDS Tracks</strong>: Downloads detailed GPS tracks for each trip</li>
<li>
<strong>Preprocess Tracks</strong>: Creates spatial grid summaries of fishing activity</li>
<li>
<strong>Export Data</strong>: Uploads processed data to MongoDB with geospatial indexing</li>
</ol>
</div>
<div class="section level2">
<h2 id="data-products">Data Products<a class="anchor" aria-label="anchor" href="#data-products"></a>
</h2>
<p>The pipeline produces several key data products:</p>
<ul>
<li>
<strong>Trip Data</strong>: Basic trip information (start/end times, vessel info)</li>
<li>
<strong>Track Data</strong>: Detailed GPS points with speed, heading, and temporal information</li>
<li>
<strong>Grid Summaries</strong>: Spatial aggregations showing:
<ul>
<li>Time spent fishing in each grid cell</li>
<li>Average speed and vessel metrics</li>
<li>Temporal patterns of activity</li>
</ul>
</li>
<li>
<strong>Regional Metrics</strong>: Time series data with currency-converted economic indicators</li>
</ul>
</div>
<div class="section level2">
<h2 id="spatial-analysis-capabilities">Spatial Analysis Capabilities<a class="anchor" aria-label="anchor" href="#spatial-analysis-capabilities"></a>
</h2>
<p>The package supports multi-scale spatial analysis:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fine-scale analysis (100m grids)</span></span>
<span><span class="fu"><a href="reference/preprocess_pds_tracks.html">preprocess_pds_tracks</a></span><span class="op">(</span>grid_size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Broad-scale patterns (1km grids)  </span></span>
<span><span class="fu"><a href="reference/preprocess_pds_tracks.html">preprocess_pds_tracks</a></span><span class="op">(</span>grid_size <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>Grid summaries include: - <code>time_spent_mins</code>: Total fishing time per grid cell - <code>mean_speed</code>: Average vessel speed - <code>n_points</code>: Number of GPS observations - <code>first_seen</code>/<code>last_seen</code>: Temporal extent of activity</p>
</div>
<div class="section level2">
<h2 id="cloud-storage-integration">Cloud Storage Integration<a class="anchor" aria-label="anchor" href="#cloud-storage-integration"></a>
</h2>
<p>The package seamlessly integrates with Google Cloud Storage:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Upload processed data</span></span>
<span><span class="fu"><a href="reference/upload_cloud_file.html">upload_cloud_file</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"processed_data.parquet"</span>,</span>
<span>  provider <span class="op">=</span> <span class="st">"google"</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bucket <span class="op">=</span> <span class="st">"your-bucket"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download data for analysis</span></span>
<span><span class="fu"><a href="reference/download_cloud_file.html">download_cloud_file</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"pds_trips_v1.0.0.parquet"</span>,</span>
<span>  provider <span class="op">=</span> <span class="st">"google"</span>, </span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bucket <span class="op">=</span> <span class="st">"your-bucket"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mongodb-integration">MongoDB Integration<a class="anchor" aria-label="anchor" href="#mongodb-integration"></a>
</h2>
<p>Geospatial data is stored in MongoDB with appropriate indexing:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Push data with geospatial indexing</span></span>
<span><span class="fu"><a href="reference/mdb_collection_push.html">mdb_collection_push</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">spatial_data</span>,</span>
<span>  connection_string <span class="op">=</span> <span class="st">"mongodb://..."</span>,</span>
<span>  collection_name <span class="op">=</span> <span class="st">"fishing_areas"</span>,</span>
<span>  geo <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Creates 2dsphere index</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>This package is part of the WorldFish Center’s Peskas initiative for small-scale fisheries monitoring. Contributions are welcome via GitHub issues and pull requests.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>GPL (&gt;= 3)</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="SUPPORT.html">Getting help</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing coasts</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Lorenzo Longobardi <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lorenzo Longobardi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
